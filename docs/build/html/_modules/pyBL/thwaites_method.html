
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pyBL.thwaites_method &#8212; pyBL 0.0.4-develop documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for pyBL.thwaites_method</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Implementations of Thwaites&#39; method.</span>

<span class="sd">This module contains the necessary classes and data for the implementation of</span>
<span class="sd">Thwaites&#39; one equation integral boundary layer method. There are two concrete</span>
<span class="sd">implementations: :class:`ThwaitesMethodLinear` that is based on the traditional</span>
<span class="sd">assumption that the ODE to be solved fits a linear relationship, and</span>
<span class="sd">:class:`ThwaitesMethodNonlinear` that removes the linear relationship</span>
<span class="sd">assumption and provides slightly better results in all cases tested.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">abstractmethod</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">CubicSpline</span>
<span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="kn">import</span> <span class="n">derivative</span> <span class="k">as</span> <span class="n">fd</span>

<span class="kn">from</span> <span class="nn">pyBL.ibl_base</span> <span class="kn">import</span> <span class="n">IBLBase</span>
<span class="kn">from</span> <span class="nn">pyBL.ibl_base</span> <span class="kn">import</span> <span class="n">IBLTermEventBase</span>


<div class="viewcode-block" id="ThwaitesMethodBase"><a class="viewcode-back" href="../../api/_autosummary/pyBL.thwaites_method.ThwaitesMethodBase.html#pyBL.thwaites_method.ThwaitesMethodBase">[docs]</a><span class="k">class</span> <span class="nc">ThwaitesMethodBase</span><span class="p">(</span><span class="n">IBLBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for Thwaites&#39; Method.</span>

<span class="sd">    This class models a laminar boundary layer using Thwaites&#39; Method from,</span>
<span class="sd">    “Approximate Calculation of the Laminar Boundary Layer.” **The Aeronautical</span>
<span class="sd">    Journal**, Vol. 1, No. 3, 1949, pp. 245–280. It is the base class for the</span>
<span class="sd">    linear (:class:`ThwaitesMethodLinear`)and nonlinear</span>
<span class="sd">    (:class:`ThwaitesMethodNonlinear`) versions of Thwaites method.</span>

<span class="sd">    In addition to the :class:`IBLBase` configuration information, the</span>
<span class="sd">    initial momentum thickness is needed along with the kinematic viscosity.</span>
<span class="sd">    Thwaites&#39; original algorithm relied upon tabulated data for the analysis,</span>
<span class="sd">    and there are few different ways of modeling that data in this class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Attributes</span>
    <span class="c1">#    _delta_m0: Momentum thickness at start location</span>
    <span class="c1">#    _nu: Kinematic viscosity</span>
    <span class="c1">#    _model: Collection of functions for S, H, and H&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">U_e</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dU_edx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">d2U_edx2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">data_fits</span><span class="o">=</span><span class="s2">&quot;Spline&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">U_e</span><span class="p">,</span> <span class="n">dU_edx</span><span class="p">,</span> <span class="n">d2U_edx2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_data_fits</span><span class="p">(</span><span class="n">data_fits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nu</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_delta_m0</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="ThwaitesMethodBase.set_solution_parameters"><a class="viewcode-back" href="../../api/_autosummary/pyBL.thwaites_method.ThwaitesMethodBase.html#pyBL.thwaites_method.ThwaitesMethodBase.set_solution_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_solution_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x_end</span><span class="p">,</span> <span class="n">delta_m0</span><span class="p">,</span> <span class="n">nu</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the parameters needed for the solver to propagate.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x0: float</span>
<span class="sd">            Location to start integration.</span>
<span class="sd">        x_end: float</span>
<span class="sd">            Location to end integration.</span>
<span class="sd">        delta_m0: float</span>
<span class="sd">            Momentum thickness at start location.</span>
<span class="sd">        nu: float</span>
<span class="sd">            Kinematic viscosity.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            When negative viscosity provided, or invalid initial conditions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">nu</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Viscosity must be positive&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">delta_m0</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Initial momentum thickness must be positive&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_nu</span> <span class="o">=</span> <span class="n">nu</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_delta_m0</span> <span class="o">=</span> <span class="n">delta_m0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_x_range</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x_end</span><span class="p">)</span></div>

<div class="viewcode-block" id="ThwaitesMethodBase.nu"><a class="viewcode-back" href="../../api/_autosummary/pyBL.thwaites_method.ThwaitesMethodBase.html#pyBL.thwaites_method.ThwaitesMethodBase.nu">[docs]</a>    <span class="k">def</span> <span class="nf">nu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return kinematic viscosity used for the solution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Kinematic viscosity.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nu</span></div>

<div class="viewcode-block" id="ThwaitesMethodBase.set_data_fits"><a class="viewcode-back" href="../../api/_autosummary/pyBL.thwaites_method.ThwaitesMethodBase.html#pyBL.thwaites_method.ThwaitesMethodBase.set_data_fits">[docs]</a>    <span class="k">def</span> <span class="nf">set_data_fits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_fits</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the data fit functions.</span>

<span class="sd">        This method sets the functions used for the data fits of the shear</span>
<span class="sd">        function, shape function, and the slope of the shape function.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            data_fits: 2-tuple, 3-tuple, or string</span>
<span class="sd">                The data fits can be set via one of the following methods:</span>
<span class="sd">                    - 3-tuple of callable objects taking one parameter that</span>
<span class="sd">                      represent the shear function, the shape function, and</span>
<span class="sd">                      the derivative of the shape function;</span>
<span class="sd">                    - 2-tuple of callable objects taking one parameter that</span>
<span class="sd">                      represent the shear function and the shape function.</span>
<span class="sd">                      The derivative of the shear function is then</span>
<span class="sd">                      approximated using finite differences; or</span>
<span class="sd">                    - String for representing one of the three internal</span>
<span class="sd">                      implementations:</span>

<span class="sd">                         - &quot;Spline&quot; for spline fits of Thwaites original</span>
<span class="sd">                           data (Edland 2022)</span>
<span class="sd">                         - &quot;White&quot; for the curve fits from White (2011)</span>
<span class="sd">                         - &quot;Cebeci-Bradshaw&quot; for curve fits from</span>
<span class="sd">                           Cebeci-Bradshaw (1977)</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            When an invalid fit name or unusable 2-tuple or 3-tuple provided</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=too-many-branches</span>
        <span class="c1"># data_fits can either be string or 2-tuple of callables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_fits</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">data_fits</span> <span class="o">==</span> <span class="s2">&quot;Spline&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">_ThwaitesFunctionsSpline</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">data_fits</span> <span class="o">==</span> <span class="s2">&quot;White&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">_ThwaitesFunctionsWhite</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">data_fits</span> <span class="o">==</span> <span class="s2">&quot;Cebeci-Bradshaw&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">_ThwaitesFunctionsCebeciBradshaw</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown fitting function name: &quot;</span><span class="p">,</span> <span class="n">data_fits</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># check to make sure have two callables</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_fits</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_fits</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">data_fits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="n">callable</span><span class="p">(</span><span class="n">data_fits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> \
                            <span class="ow">and</span> <span class="n">callable</span><span class="p">(</span><span class="n">data_fits</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">_ThwaitesFunctionsBase</span><span class="p">(</span><span class="s2">&quot;Custom&quot;</span><span class="p">,</span>
                                                             <span class="n">data_fits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                             <span class="n">data_fits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                             <span class="n">data_fits</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                                             <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need to pass callable objects for &quot;</span>
                                         <span class="s2">&quot;fit functions&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_fits</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">data_fits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="n">callable</span><span class="p">(</span><span class="n">data_fits</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="k">def</span> <span class="nf">Hp_fun</span><span class="p">(</span><span class="n">lam</span><span class="p">):</span>
                            <span class="k">return</span> <span class="n">fd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">_ThwaitesFunctionsBase</span><span class="p">(</span><span class="s2">&quot;Custom&quot;</span><span class="p">,</span>
                                                             <span class="n">data_fits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                             <span class="n">data_fits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                             <span class="n">Hp_fun</span><span class="p">,</span>
                                                             <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need to pass callable objects for &quot;</span>
                                         <span class="s2">&quot;fit functions&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need to pass two or three callable &quot;</span>
                                     <span class="s2">&quot;objects for fit functions&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need to pass a 2-tuple for fit functions&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_kill_event</span><span class="p">(</span><span class="n">_ThwaitesSeparationEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_calc_lambda</span><span class="p">,</span>
                                                      <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">S</span><span class="p">))</span></div>

<div class="viewcode-block" id="ThwaitesMethodBase.solve"><a class="viewcode-back" href="../../api/_autosummary/pyBL.thwaites_method.ThwaitesMethodBase.html#pyBL.thwaites_method.ThwaitesMethodBase.solve">[docs]</a>    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term_event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Solve the ODE associated with Thwaites&#39; method.</span>

<span class="sd">        This actually solves the following differential equation</span>

<span class="sd">        .. math:: \frac{d}{dx}\left(\frac{\delta_m^2}{\nu}\right)=\frac{F}{U_e}</span>

<span class="sd">        where :math:`F` is either the linear approximation or the actual term</span>
<span class="sd">        from Thwaites&#39; original paper.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        term_event : List based on :class:`IBLTermEventBase`, optional</span>
<span class="sd">            User events that can terminate the integration process before the</span>
<span class="sd">            end location of the integration is reached. The default is `None`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`IBLResult`</span>
<span class="sd">            Information associated with the integration process.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solve_impl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delta_m0</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">_nu</span><span class="p">,</span>
                                <span class="n">term_event</span><span class="o">=</span><span class="n">term_event</span><span class="p">)</span></div>

<div class="viewcode-block" id="ThwaitesMethodBase.V_e"><a class="viewcode-back" href="../../api/_autosummary/pyBL.thwaites_method.ThwaitesMethodBase.html#pyBL.thwaites_method.ThwaitesMethodBase.V_e">[docs]</a>    <span class="k">def</span> <span class="nf">V_e</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the transpiration velocity.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x: array-like</span>
<span class="sd">            Streamwise loations to calculate this property.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        array-like same shape as `x`</span>
<span class="sd">            Desired transpiration velocity at the specified locations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">U_e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">U_e</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">dU_edx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dU_edx</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">delta_m2_on_nu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solution</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="n">dU_edx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">delta_d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nu</span><span class="o">/</span><span class="n">delta_m2_on_nu</span><span class="p">)</span>
        <span class="n">dsol_dx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ode_impl</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">delta_m2_on_nu</span><span class="p">)</span>
        <span class="n">term3</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">U_e</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">H_d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">dsol_dx</span>
        <span class="n">term4a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">Hp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_calc_lambda</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">delta_m2_on_nu</span><span class="p">))</span>
        <span class="n">term4</span> <span class="o">=</span> <span class="n">U_e</span><span class="o">*</span><span class="n">delta_m2_on_nu</span><span class="o">*</span><span class="n">term4a</span>
        <span class="n">term5</span> <span class="o">=</span> <span class="n">dU_edx</span><span class="o">*</span><span class="n">dsol_dx</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">d2U_edx2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">delta_m2_on_nu</span>
        <span class="k">return</span> <span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span><span class="o">*</span><span class="p">(</span><span class="n">term3</span><span class="o">+</span><span class="n">term4</span><span class="o">*</span><span class="n">term5</span><span class="p">)</span></div>

<div class="viewcode-block" id="ThwaitesMethodBase.delta_d"><a class="viewcode-back" href="../../api/_autosummary/pyBL.thwaites_method.ThwaitesMethodBase.html#pyBL.thwaites_method.ThwaitesMethodBase.delta_d">[docs]</a>    <span class="k">def</span> <span class="nf">delta_d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the displacement thickness.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x: array-like</span>
<span class="sd">            Streamwise loations to calculate this property.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        array-like same shape as `x`</span>
<span class="sd">            Desired displacement thickness at the specified locations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_m</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">H_d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div>

<div class="viewcode-block" id="ThwaitesMethodBase.delta_m"><a class="viewcode-back" href="../../api/_autosummary/pyBL.thwaites_method.ThwaitesMethodBase.html#pyBL.thwaites_method.ThwaitesMethodBase.delta_m">[docs]</a>    <span class="k">def</span> <span class="nf">delta_m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the momentum thickness.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x: array-like</span>
<span class="sd">            Streamwise loations to calculate this property.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        array-like same shape as `x`</span>
<span class="sd">            Desired momentum thickness at the specified locations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_solution</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_nu</span><span class="p">)</span></div>

<div class="viewcode-block" id="ThwaitesMethodBase.delta_k"><a class="viewcode-back" href="../../api/_autosummary/pyBL.thwaites_method.ThwaitesMethodBase.html#pyBL.thwaites_method.ThwaitesMethodBase.delta_k">[docs]</a>    <span class="k">def</span> <span class="nf">delta_k</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the kinetic energy thickness.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x: array-like</span>
<span class="sd">            Streamwise loations to calculate this property.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        array-like same shape as `x`</span>
<span class="sd">            Desired kinetic energy thickness at the specified locations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div>

<div class="viewcode-block" id="ThwaitesMethodBase.H_d"><a class="viewcode-back" href="../../api/_autosummary/pyBL.thwaites_method.ThwaitesMethodBase.html#pyBL.thwaites_method.ThwaitesMethodBase.H_d">[docs]</a>    <span class="k">def</span> <span class="nf">H_d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the displacement shape factor.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x: array-like</span>
<span class="sd">            Streamwise loations to calculate this property.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        array-like same shape as `x`</span>
<span class="sd">            Desired displacement shape factor at the specified locations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_lambda</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solution</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">H</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span></div>

<div class="viewcode-block" id="ThwaitesMethodBase.H_k"><a class="viewcode-back" href="../../api/_autosummary/pyBL.thwaites_method.ThwaitesMethodBase.html#pyBL.thwaites_method.ThwaitesMethodBase.H_k">[docs]</a>    <span class="k">def</span> <span class="nf">H_k</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the kinetic energy shape factor.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x: array-like</span>
<span class="sd">            Streamwise loations to calculate this property.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        array-like same shape as `x`</span>
<span class="sd">            Desired kinetic energy shape factor at the specified locations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_k</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">delta_m</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div>

<div class="viewcode-block" id="ThwaitesMethodBase.tau_w"><a class="viewcode-back" href="../../api/_autosummary/pyBL.thwaites_method.ThwaitesMethodBase.html#pyBL.thwaites_method.ThwaitesMethodBase.tau_w">[docs]</a>    <span class="k">def</span> <span class="nf">tau_w</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">rho</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the wall shear stress.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x: array-like</span>
<span class="sd">            Streamwise loations to calculate this property.</span>
<span class="sd">        rho: float</span>
<span class="sd">            Freestream density.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        array-like same shape as `x`</span>
<span class="sd">            Desired wall shear stress at the specified locations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_lambda</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solution</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">rho</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_nu</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">U_e</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">delta_m</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div>

<div class="viewcode-block" id="ThwaitesMethodBase.D"><a class="viewcode-back" href="../../api/_autosummary/pyBL.thwaites_method.ThwaitesMethodBase.html#pyBL.thwaites_method.ThwaitesMethodBase.D">[docs]</a>    <span class="k">def</span> <span class="nf">D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">rho</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the dissipation integral.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x: array-like</span>
<span class="sd">            Streamwise loations to calculate this property.</span>
<span class="sd">        rho: float</span>
<span class="sd">            Freestream density.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        array-like same shape as `x`</span>
<span class="sd">            Desired dissipation integral at the specified locations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># To Do: This needs to be implemented</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method needs to be implemented.&quot;</span><span class="p">)</span></div>
<span class="c1">#        return np.zeros_like(x)</span>

    <span class="k">def</span> <span class="nf">_ode_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">delta_m2_on_nu</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Right-hand-side of the ODE representing Thwaites method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x: array-like</span>
<span class="sd">            Streamwise location of current step.</span>
<span class="sd">        delta_m2_on_nu: array-like</span>
<span class="sd">            Current step&#39;s square of momentum thickness divided by the</span>
<span class="sd">            kinematic viscosity.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        array-like same shape as `delta_m2_on_nu`</span>
<span class="sd">            The right-hand side of the ODE at the given state.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_F</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">delta_m2_on_nu</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1e-3</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">U_e</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_calc_F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">delta_m2_on_nu</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the :math:`F` term in the ODE.</span>

<span class="sd">        The F term captures the interaction between the shear function and the</span>
<span class="sd">        shape function and can be modeled as a linear expression (as the</span>
<span class="sd">        standard Thwaites&#39; method does) or can be calculated directly using</span>
<span class="sd">        the data fit relations for the shear function and the shape function.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : array-like</span>
<span class="sd">            Streamwise location of current step.</span>
<span class="sd">        delta_m2_on_nu : array-like</span>
<span class="sd">            Dependent variable in the ODE solver.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        array-like same shape as `x`</span>
<span class="sd">            The calculated value of :math:`F`</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_calc_lambda</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">delta_m2_on_nu</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the :math:`\lambda` term needed in Thwaites&#39; method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : array-like</span>
<span class="sd">            Streamwise location of current step.</span>
<span class="sd">        delta_m2_on_nu : array-like</span>
<span class="sd">            Dependent variable in the ODE solver.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        array-like same shape as `x`</span>
<span class="sd">            The :math:`\lambda` parameter that corresponds to the given state.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">delta_m2_on_nu</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dU_edx</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div>


<div class="viewcode-block" id="ThwaitesMethodLinear"><a class="viewcode-back" href="../../api/_autosummary/pyBL.thwaites_method.ThwaitesMethodLinear.html#pyBL.thwaites_method.ThwaitesMethodLinear">[docs]</a><span class="k">class</span> <span class="nc">ThwaitesMethodLinear</span><span class="p">(</span><span class="n">ThwaitesMethodBase</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Laminar boundary layer model using Thwaites Method linear approximation.</span>

<span class="sd">    Solves the original approximate ODE from Thwaites&#39; method when provided</span>
<span class="sd">    the edge velocity profile. There are a few different ways of modeling the</span>
<span class="sd">    tabular data from Thwaites original work that can be set.</span>

<span class="sd">    This class solves the following differential equation using the linear</span>
<span class="sd">    approximation from Thwaites&#39; original paper</span>

<span class="sd">    .. math::</span>
<span class="sd">        \frac{d}{dx}\left(\frac{\delta_m^2}{\nu}\right)</span>
<span class="sd">            =\frac{1}{U_e}\left(0.45-6\lambda\right)</span>

<span class="sd">    using the :class:`IBLBase` ODE solver.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_calc_F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">delta_m2_on_nu</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the :math:`F` term in the ODE using the linear approximation.</span>

<span class="sd">        The F term captures the interaction between the shear function and the</span>
<span class="sd">        shape function and is modeled as the following linear expression (as</span>
<span class="sd">        the standard Thwaites&#39; method does)</span>

<span class="sd">        .. math:: F\left(\lambda\right)=0.45-6\lambda</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : array-like</span>
<span class="sd">            Streamwise location of current step.</span>
<span class="sd">        delta_m2_on_nu : array-like</span>
<span class="sd">            Dependent variable in the ODE solver.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        array-like same shape as `x`</span>
<span class="sd">            The calculated value of :math:`F`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_lambda</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">delta_m2_on_nu</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mf">0.45</span>
        <span class="n">b</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">lam</span></div>


<div class="viewcode-block" id="ThwaitesMethodNonlinear"><a class="viewcode-back" href="../../api/_autosummary/pyBL.thwaites_method.ThwaitesMethodNonlinear.html#pyBL.thwaites_method.ThwaitesMethodNonlinear">[docs]</a><span class="k">class</span> <span class="nc">ThwaitesMethodNonlinear</span><span class="p">(</span><span class="n">ThwaitesMethodBase</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Laminar boundary layer model using Thwaites&#39; Method using exact ODE.</span>

<span class="sd">    Solves the original ODE from Thwaites&#39; Method (1949) without the linear</span>
<span class="sd">    approximation when provided the edge velocity profile. There are a few</span>
<span class="sd">    different ways of modeling the tabular data from Thwaites original work</span>
<span class="sd">    that can be set.</span>

<span class="sd">    This class solves the following differential equation using the data fits</span>
<span class="sd">    for the shear function, :math:`S`, and the shape function, :math`H`, to</span>
<span class="sd">    capture a more accurate representation of the laminar boundary layer flow</span>

<span class="sd">    .. math::</span>
<span class="sd">        \frac{d}{dx}\left(\frac{\delta_m^2}{\nu}\right)</span>
<span class="sd">            =\frac{2}{U_e}\left[S-\lambda\left(H+2\right)\right]</span>

<span class="sd">    using the :class:`IBLBase` ODE solver.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_calc_F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">delta_m2_on_nu</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the :math:`F` term in the ODE using the actual relationship.</span>

<span class="sd">        The F term captures the interaction between the shear function and the</span>
<span class="sd">        shape function and is modeled as the original ODE expression from</span>
<span class="sd">        Thwaites&#39; paper as</span>

<span class="sd">        .. math:: F\left(\lambda\right)=2\left[S-\lambda\left(H+2\right)\right]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : array-like</span>
<span class="sd">            Streamwise location of current step.</span>
<span class="sd">        delta_m2_on_nu : array-like</span>
<span class="sd">            Dependent variable in the ODE solver.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        array-like same shape as `x`</span>
<span class="sd">            The calculated value of :math:`F`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_lambda</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">delta_m2_on_nu</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">F</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span></div>


<span class="k">class</span> <span class="nc">_ThwaitesFunctionsBase</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Base class for curve fits for Thwaites data.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">S_fun</span><span class="p">,</span> <span class="n">H_fun</span><span class="p">,</span> <span class="n">Hp_fun</span><span class="p">,</span> <span class="n">lambda_min</span><span class="p">,</span> <span class="n">lambda_max</span><span class="p">):</span>
        <span class="c1"># pylint: disable=too-many-arguments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">lambda_min</span><span class="p">,</span> <span class="n">lambda_max</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_H_fun</span> <span class="o">=</span> <span class="n">H_fun</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Hp_fun</span> <span class="o">=</span> <span class="n">Hp_fun</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_S_fun</span> <span class="o">=</span> <span class="n">S_fun</span>

    <span class="k">def</span> <span class="nf">range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a 2-tuple for the start and end of range.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">H</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lam</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the H term.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H_fun</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_check_range</span><span class="p">(</span><span class="n">lam</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">Hp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lam</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the H&#39; term.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Hp_fun</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_check_range</span><span class="p">(</span><span class="n">lam</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">S</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lam</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the S term.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_S_fun</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_check_range</span><span class="p">(</span><span class="n">lam</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lam</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the F term.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span> <span class="o">-</span> <span class="n">lam</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return name of function set.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="k">def</span> <span class="nf">_check_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lam</span><span class="p">):</span>
        <span class="n">lam_min</span><span class="p">,</span> <span class="n">lam_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">()</span>
        <span class="n">lam_local</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">lam_local</span> <span class="o">&lt;</span> <span class="n">lam_min</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">lam_local</span><span class="p">[</span><span class="n">lam_local</span> <span class="o">&lt;</span> <span class="n">lam_min</span><span class="p">]</span> <span class="o">=</span> <span class="n">lam_min</span>
<span class="c1">#            raise ValueError(&quot;Cannot pass value less than {} into this &quot;</span>
<span class="c1">#                             &quot;function: {}&quot;.format(lam_min, lam))</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">lam_local</span> <span class="o">&gt;</span> <span class="n">lam_max</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">lam_local</span><span class="p">[</span><span class="n">lam_local</span> <span class="o">&gt;</span> <span class="n">lam_max</span><span class="p">]</span> <span class="o">=</span> <span class="n">lam_max</span>
<span class="c1">#            raise ValueError(&quot;Cannot pass value greater than {} into this &quot;</span>
<span class="c1">#                             &quot;function: {}&quot;.format(lam_max, lam))</span>
        <span class="k">return</span> <span class="n">lam_local</span>


<span class="k">class</span> <span class="nc">_ThwaitesFunctionsWhite</span><span class="p">(</span><span class="n">_ThwaitesFunctionsBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns White&#39;s calculation of Thwaites functions.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">S</span><span class="p">(</span><span class="n">lam</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="n">lam</span> <span class="o">+</span> <span class="mf">0.09</span><span class="p">,</span> <span class="mf">0.62</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">H</span><span class="p">(</span><span class="n">lam</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">-</span> <span class="n">lam</span>
            <span class="k">return</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="mf">4.14</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">83.5</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="mi">854</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3337</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="mi">4576</span><span class="p">))))</span>

        <span class="k">def</span> <span class="nf">Hp</span><span class="p">(</span><span class="n">lam</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">-</span> <span class="n">lam</span>
            <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="mf">4.14</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="mf">83.5</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">854</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="mi">3337</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">4576</span><span class="p">))))</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;White&quot;</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Hp</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_ThwaitesFunctionsCebeciBradshaw</span><span class="p">(</span><span class="n">_ThwaitesFunctionsBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns Cebeci and Bradshaw&#39;s calculation of Thwaites functions.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">S</span><span class="p">(</span><span class="n">lam</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="p">[</span><span class="n">lam</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lam</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">],</span>
                                <span class="p">[</span><span class="k">lambda</span> <span class="n">lam</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.22</span> <span class="o">+</span> <span class="mf">1.402</span><span class="o">*</span><span class="n">lam</span>
                                              <span class="o">+</span> <span class="mf">0.018</span><span class="o">*</span><span class="n">lam</span><span class="o">/</span><span class="p">(</span><span class="mf">0.107</span> <span class="o">+</span> <span class="n">lam</span><span class="p">)),</span>
                                 <span class="k">lambda</span> <span class="n">lam</span><span class="p">:</span> <span class="mf">0.22</span> <span class="o">+</span> <span class="mf">1.57</span><span class="o">*</span><span class="n">lam</span> <span class="o">-</span> <span class="mf">1.8</span><span class="o">*</span><span class="n">lam</span><span class="o">**</span><span class="mi">2</span><span class="p">])</span>

        <span class="k">def</span> <span class="nf">H</span><span class="p">(</span><span class="n">lam</span><span class="p">):</span>
            <span class="c1"># NOTE: C&amp;B&#39;s H function is not continuous at lam=0,</span>
            <span class="c1">#       so using second interval</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="p">[</span><span class="n">lam</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lam</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">],</span>
                                <span class="p">[</span><span class="k">lambda</span> <span class="n">lam</span><span class="p">:</span> <span class="mf">2.088</span> <span class="o">+</span> <span class="mf">0.0731</span><span class="o">/</span><span class="p">(</span><span class="mf">0.14</span> <span class="o">+</span> <span class="n">lam</span><span class="p">),</span>
                                 <span class="k">lambda</span> <span class="n">lam</span><span class="p">:</span> <span class="mf">2.61</span> <span class="o">-</span> <span class="mf">3.75</span><span class="o">*</span><span class="n">lam</span> <span class="o">+</span> <span class="mf">5.24</span><span class="o">*</span><span class="n">lam</span><span class="o">**</span><span class="mi">2</span><span class="p">])</span>

        <span class="k">def</span> <span class="nf">Hp</span><span class="p">(</span><span class="n">lam</span><span class="p">):</span>
            <span class="c1"># NOTE: C&amp;B&#39;s H function is not continuous at lam=0,</span>
            <span class="c1">#       so using second interval</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="p">[</span><span class="n">lam</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lam</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">],</span>
                                <span class="p">[</span><span class="k">lambda</span> <span class="n">lam</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.0731</span><span class="o">/</span><span class="p">(</span><span class="mf">0.14</span> <span class="o">+</span> <span class="n">lam</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
                                 <span class="k">lambda</span> <span class="n">lam</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.75</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mf">5.24</span><span class="o">*</span><span class="n">lam</span><span class="p">])</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;Cebeci and Bradshaw&quot;</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Hp</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_ThwaitesFunctionsSpline</span><span class="p">(</span><span class="n">_ThwaitesFunctionsBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns cubic splines of Thwaites tables based on Edland 2021.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Spline fits to Thwaites original data Edland</span>
        <span class="n">S</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tab_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tab_S</span><span class="p">)</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tab_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tab_H</span><span class="p">)</span>
        <span class="n">Hp</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;Thwaites Splines&quot;</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Hp</span><span class="p">,</span>
                         <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tab_lambda</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tab_lambda</span><span class="p">))</span>

    <span class="c1"># Tabular data section</span>
    <span class="n">_tab_F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.938</span><span class="p">,</span> <span class="mf">0.953</span><span class="p">,</span> <span class="mf">0.956</span><span class="p">,</span> <span class="mf">0.962</span><span class="p">,</span> <span class="mf">0.967</span><span class="p">,</span> <span class="mf">0.969</span><span class="p">,</span> <span class="mf">0.971</span><span class="p">,</span> <span class="mf">0.970</span><span class="p">,</span>
                       <span class="mf">0.963</span><span class="p">,</span> <span class="mf">0.952</span><span class="p">,</span> <span class="mf">0.936</span><span class="p">,</span> <span class="mf">0.919</span><span class="p">,</span> <span class="mf">0.902</span><span class="p">,</span> <span class="mf">0.886</span><span class="p">,</span> <span class="mf">0.854</span><span class="p">,</span> <span class="mf">0.825</span><span class="p">,</span>
                       <span class="mf">0.797</span><span class="p">,</span> <span class="mf">0.770</span><span class="p">,</span> <span class="mf">0.744</span><span class="p">,</span> <span class="mf">0.691</span><span class="p">,</span> <span class="mf">0.640</span><span class="p">,</span> <span class="mf">0.590</span><span class="p">,</span> <span class="mf">0.539</span><span class="p">,</span> <span class="mf">0.490</span><span class="p">,</span>
                       <span class="mf">0.440</span><span class="p">,</span> <span class="mf">0.342</span><span class="p">,</span> <span class="mf">0.249</span><span class="p">,</span> <span class="mf">0.156</span><span class="p">,</span> <span class="mf">0.064</span><span class="p">,</span><span class="o">-</span><span class="mf">0.028</span><span class="p">,</span><span class="o">-</span><span class="mf">0.138</span><span class="p">,</span><span class="o">-</span><span class="mf">0.251</span><span class="p">,</span>
                      <span class="o">-</span><span class="mf">0.362</span><span class="p">,</span><span class="o">-</span><span class="mf">0.702</span><span class="p">,</span><span class="o">-</span><span class="mf">1.000</span><span class="p">])</span>
    <span class="n">_tab_S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.000</span><span class="p">,</span> <span class="mf">0.011</span><span class="p">,</span> <span class="mf">0.016</span><span class="p">,</span> <span class="mf">0.024</span><span class="p">,</span> <span class="mf">0.030</span><span class="p">,</span> <span class="mf">0.035</span><span class="p">,</span> <span class="mf">0.039</span><span class="p">,</span> <span class="mf">0.049</span><span class="p">,</span>
                       <span class="mf">0.055</span><span class="p">,</span> <span class="mf">0.067</span><span class="p">,</span> <span class="mf">0.076</span><span class="p">,</span> <span class="mf">0.083</span><span class="p">,</span> <span class="mf">0.089</span><span class="p">,</span> <span class="mf">0.094</span><span class="p">,</span> <span class="mf">0.104</span><span class="p">,</span> <span class="mf">0.113</span><span class="p">,</span>
                       <span class="mf">0.122</span><span class="p">,</span> <span class="mf">0.130</span><span class="p">,</span> <span class="mf">0.138</span><span class="p">,</span> <span class="mf">0.153</span><span class="p">,</span> <span class="mf">0.168</span><span class="p">,</span> <span class="mf">0.182</span><span class="p">,</span> <span class="mf">0.195</span><span class="p">,</span> <span class="mf">0.208</span><span class="p">,</span>
                       <span class="mf">0.220</span><span class="p">,</span> <span class="mf">0.244</span><span class="p">,</span> <span class="mf">0.268</span><span class="p">,</span> <span class="mf">0.291</span><span class="p">,</span> <span class="mf">0.313</span><span class="p">,</span> <span class="mf">0.333</span><span class="p">,</span> <span class="mf">0.359</span><span class="p">,</span> <span class="mf">0.382</span><span class="p">,</span>
                       <span class="mf">0.404</span><span class="p">,</span> <span class="mf">0.463</span><span class="p">,</span> <span class="mf">0.500</span><span class="p">])</span>
    <span class="n">_tab_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.70</span><span class="p">,</span> <span class="mf">3.69</span><span class="p">,</span> <span class="mf">3.66</span><span class="p">,</span> <span class="mf">3.63</span><span class="p">,</span> <span class="mf">3.61</span><span class="p">,</span> <span class="mf">3.59</span><span class="p">,</span> <span class="mf">3.58</span><span class="p">,</span> <span class="mf">3.52</span><span class="p">,</span> <span class="mf">3.47</span><span class="p">,</span>
                       <span class="mf">3.38</span><span class="p">,</span> <span class="mf">3.30</span><span class="p">,</span> <span class="mf">3.23</span><span class="p">,</span> <span class="mf">3.17</span><span class="p">,</span> <span class="mf">3.13</span><span class="p">,</span> <span class="mf">3.05</span><span class="p">,</span> <span class="mf">2.99</span><span class="p">,</span> <span class="mf">2.94</span><span class="p">,</span> <span class="mf">2.90</span><span class="p">,</span>
                       <span class="mf">2.87</span><span class="p">,</span> <span class="mf">2.81</span><span class="p">,</span> <span class="mf">2.75</span><span class="p">,</span> <span class="mf">2.71</span><span class="p">,</span> <span class="mf">2.67</span><span class="p">,</span> <span class="mf">2.64</span><span class="p">,</span> <span class="mf">2.61</span><span class="p">,</span> <span class="mf">2.55</span><span class="p">,</span> <span class="mf">2.49</span><span class="p">,</span>
                       <span class="mf">2.44</span><span class="p">,</span> <span class="mf">2.39</span><span class="p">,</span> <span class="mf">2.34</span><span class="p">,</span> <span class="mf">2.28</span><span class="p">,</span> <span class="mf">2.23</span><span class="p">,</span> <span class="mf">2.18</span><span class="p">,</span> <span class="mf">2.07</span><span class="p">,</span>  <span class="mf">2.00</span><span class="p">])</span>
    <span class="n">_tab_lambda</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.082</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0818</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0816</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0812</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0808</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0804</span><span class="p">,</span>
                            <span class="o">-</span><span class="mf">0.080</span><span class="p">,</span><span class="o">-</span><span class="mf">0.079</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.078</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.076</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.074</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.072</span><span class="p">,</span>
                            <span class="o">-</span><span class="mf">0.070</span><span class="p">,</span><span class="o">-</span><span class="mf">0.068</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.064</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.060</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.056</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.052</span><span class="p">,</span>
                            <span class="o">-</span><span class="mf">0.048</span><span class="p">,</span><span class="o">-</span><span class="mf">0.040</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.032</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.024</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.016</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.008</span><span class="p">,</span>
                             <span class="mf">0.000</span><span class="p">,</span> <span class="mf">0.016</span><span class="p">,</span>  <span class="mf">0.032</span><span class="p">,</span>  <span class="mf">0.048</span><span class="p">,</span>  <span class="mf">0.064</span><span class="p">,</span>  <span class="mf">0.080</span><span class="p">,</span>
                             <span class="mf">0.10</span><span class="p">,</span>  <span class="mf">0.12</span><span class="p">,</span>   <span class="mf">0.14</span><span class="p">,</span>   <span class="mf">0.20</span><span class="p">,</span>   <span class="mf">0.25</span><span class="p">])</span>


<span class="k">class</span> <span class="nc">_ThwaitesSeparationEvent</span><span class="p">(</span><span class="n">IBLTermEventBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Detects separation and will terminate integration when it occurs.</span>

<span class="sd">    This is a callable object that the ODE integrator will use to determine if</span>
<span class="sd">    the integration should terminate before the end location.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># pylint: disable=too-few-public-methods</span>
    <span class="c1"># Attributes</span>
    <span class="c1"># ----------</span>
    <span class="c1">#    _calc_lam: Callable that can calculate lambda.</span>
    <span class="c1">#    _S_fun: Callable that can calculate the shear function.</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">calc_lam</span><span class="p">,</span> <span class="n">S_fun</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_calc_lam</span> <span class="o">=</span> <span class="n">calc_lam</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_S_fun</span> <span class="o">=</span> <span class="n">S_fun</span>

    <span class="k">def</span> <span class="nf">_call_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">F</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Help determine if Thwaites method integrator should terminate.</span>

<span class="sd">        This will terminate once the shear function goes negative.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x: array-like</span>
<span class="sd">            Current x-location of the integration.</span>
<span class="sd">        F: array-like</span>
<span class="sd">            Current step square of momentum thickness divided by the</span>
<span class="sd">            kinematic viscosity.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Current value of the shear function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_S_fun</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_calc_lam</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">F</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">event_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">pyBL</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developers/index.html">Developer Resources</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ddmarshall/IBL">Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license/index.html">License</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, David D. Marshall.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>